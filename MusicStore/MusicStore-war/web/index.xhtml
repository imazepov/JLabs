<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:f="http://java.sun.com/jsf/core">
    <ui:composition template="base.xhtml">
        <ui:define name="title">Guitars, harmonicas and more</ui:define>
        
        
            <ui:define name="content">
                <c:if test="#{param.submitted}">
                    <h5>Заказ успешно отправлен</h5>
                </c:if>
                
                <h:form>
                    <div>
                        <ui:repeat value="#{shopping.goods}" var="item">
                            <div class="article">                            
                                <h:graphicImage url="/media/#{item.photoFileName}" width="120" height="50"/><br/>
                                <h3><h:outputText value="#{item.name}"/></h3>
                                <blockquote>
                                    <h:outputText value="#{item.description}"/>
                                </blockquote>
                                <div><i>Цена: <h:outputText value="#{item.price}"/> грн</i></div>
                                <h:commandLink value="Купить" action="#{shopping.addToCart}">
                                    <f:param name="article" value="#{item.id}"/>
                                </h:commandLink>
                                
                                <c:if test="#{admin.isAllowed}">   
                                    <br/>
                                    <h:commandLink action="#{admin.removeArticle}" value="Удалить">
                                        <f:setPropertyActionListener target="#{admin.articleToRemove}" value="#{item.id}"/>
                                    </h:commandLink>
                                </c:if>
                            </div>                            
                        </ui:repeat>
                    </div>
                </h:form> 
                
                <c:if test="#{admin.isAllowed}">
                    <h:form>
                        <h:panelGrid columns="2">
                            <h:outputLabel value="Название:"/>
                            <h:inputText id="name" value="#{admin.articleName}" required="true"/>
                            <h:outputLabel value="Фото:"/>
                            <h:inputText id="photo" />
                            <h:outputLabel value="Описание:"/>
                            <h:inputTextarea id="description" value="#{admin.articleDescription}" required="true"/>
                            <h:outputLabel value="Цена:"/>
                            <h:inputText id="price" value="#{admin.articlePrice}"/>
                            <h:outputLabel value="Категория:"/>
                            <h:selectOneMenu id="category" value="#{admin.articleCategory}" converter="#{categoryConverter}">
                                <f:selectItems value="#{shopping.categories}" var="category" itemLabel="#{category.name}"
                                               />
                            </h:selectOneMenu>
                        </h:panelGrid>
                        <h:commandButton value="Добавить" action="#{admin.addArticle}"/>
                    </h:form>
                </c:if>

            </ui:define>
 
    </ui:composition>   
    
</html>

